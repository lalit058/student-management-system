{% extends 'hod_template/base_template.html' %}
{% block page_title %}
Manage Admins
{% endblock page_title %}
{% load static %}
{% block main_content %}
<!-- Main content -->
<section class="content">
  <div class="container-fluid">
    <!-- Message Display -->
    <div class="row">
      <div class="col-12">
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        {% endfor %}
        {% endif %}
      </div>
    </div>
    <!-- End Message Display -->

    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Admin Details</h3>
            <div class="card-tools">
              <div class="input-group input-group-sm" style="width: 300px;">
              <a href="{% url 'add_student' %}" class="btn btn-sm btn-success mr-2">
                <i class="fas fa-plus"></i> Add Student
              </a>
                <input type="text" name="table_search" class="form-control float-right" placeholder="Search admins...">
                <div class="input-group-append">
                  <button type="submit" class="btn btn-default">
                    <i class="fas fa-search"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- /.card-header -->
          <div class="card-body table-responsive p-0">
            <table class="table table-hover text-nowrap">
              <thead class="light-blue">
                <tr class="second-head">
                  <th>ID</th>
                  <th>Profile</th>
                  <th>First Name</th>
                  <th>Last Name</th>
                  <th>Username</th>
                  <th>Email</th>
                  <th>Phone</th>
                  <th>Gender</th>
                  <th>Qualification</th>
                  <th>Last Login</th>
                  <th>Date Joined</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for admin in admins %}
                <tr>
                  <td>{{ admin.admin.id }}</td>
                  <td>
                    {% if admin.profile_pic %}
                    <img src="{{ admin.profile_pic.url }}" class="img-circle elevation-2" width="40" height="40"
                      alt="Profile">
                    {% else %}
                    <img src="{% static 'dist/img/user2-160x160.jpg' %}" class="img-circle elevation-2" width="40"
                      height="40" alt="Default Profile">
                    {% endif %}
                  </td>
                  <td>{{ admin.admin.first_name }}</td>
                  <td>{{ admin.admin.last_name }}</td>
                  <td>{{ admin.admin.username }}</td>
                  <td>{{ admin.admin.email }}</td>
                  <td>{{ admin.phone_number|default:"-" }}</td>
                  <td>{{ admin.gender }}</td>
                  <td>{{ admin.qualification|default:"-" }}</td>
                  <td>{{ admin.admin.last_login|default:"Never" }}</td>
                  <td>{{ admin.admin.date_joined|date:"Y-m-d" }}</td>
                  <td>
                    <a href="{% url 'edit_admin' admin_id=admin.admin.id %}" class="btn btn-success btn-sm"
                      title="Edit">
                      <i class="fas fa-edit"></i>
                    </a>
                    <button class="btn btn-danger btn-sm" data-toggle="modal"
                      data-target="#deleteModal{{ admin.admin.id }}" title="Delete">
                      <i class="fas fa-trash"></i>
                    </button>
                    <a href="{% url 'admin_profile_view' admin_id=admin.admin.id %}" class="btn btn-info btn-sm"
                      title="View Profile">
                      <i class="fas fa-eye"></i>
                    </a>
                  </td>
                </tr>

                <!-- Delete Modal for each admin -->
                <div class="modal fade" id="deleteModal{{ admin.admin.id }}" tabindex="-1" role="dialog"
                  aria-labelledby="deleteModalLabel" aria-hidden="true">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabel">Delete Admin</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <div class="text-center mb-3">
                          {% if admin.profile_pic %}
                          <img src="{{ admin.profile_pic.url }}" class="img-circle elevation-2" width="100" height="100"
                            alt="Profile">
                          {% else %}
                          <img src="{% static 'dist/img/user2-160x160.jpg' %}" class="img-circle elevation-2"
                            width="100" height="100" alt="Default Profile">
                          {% endif %}
                        </div>
                        Are you sure you want to delete admin:
                        <strong>{{ admin.admin.first_name }} {{ admin.admin.last_name }}</strong>?
                        <br><br>
                        <div class="alert alert-warning">
                          <i class="fas fa-exclamation-triangle"></i>
                          This will permanently delete all associated data including:
                          <ul>
                            <li>Admin account</li>
                            <li>All admin privileges</li>
                            <li>Associated records</li>
                          </ul>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <form method="POST" action="{% url 'delete_admin' admin_id=admin.admin.id %}">
                          {% csrf_token %}
                          <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Confirm Delete
                          </button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </tbody>
            </table>
          </div>

          <!-- /.card-body -->
          <div class="card-footer clearfix">
            <div class="float-left">
              Showing <strong>{{ admins.start_index }}</strong> to <strong>{{ admins.end_index }}</strong> of <strong>{{
                admins.paginator.count }}</strong> admins
            </div>
            <div class="float-right">
              {% if admins.has_other_pages %}
              <ul class="pagination pagination-sm m-0">
                {% if admins.has_previous %}
                <li class="page-item"><a class="page-link" href="?page=1">&laquo; First</a></li>
                <li class="page-item"><a class="page-link" href="?page={{ admins.previous_page_number }}">Previous</a>
                </li>
                {% endif %}

                {% for i in admins.paginator.page_range %}
                {% if admins.number == i %}
                <li class="page-item active"><span class="page-link">{{ i }}</span></li>
                {% elif i > admins.number|add:'-3' and i < admins.number|add:'3' %} <li class="page-item"><a
                    class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                  {% endif %}
                  {% endfor %}

                  {% if admins.has_next %}
                  <li class="page-item"><a class="page-link" href="?page={{ admins.next_page_number }}">Next</a></li>
                  <li class="page-item"><a class="page-link" href="?page={{ admins.paginator.num_pages }}">Last
                      &raquo;</a></li>
                  {% endif %}
              </ul>
              {% endif %}
            </div>
          </div>
        </div>
        <!-- /.card -->
      </div>
    </div>
  </div>
</section>
<!-- /.content -->
{% endblock main_content %}

{% block custom_js %}
<script>
  $(document).ready(function () {
    // Initialize any custom JavaScript here
  });
</script>
<style>
  .col-12 {
    -ms-flex: 0 0 100% !important;
    flex: 0 0 100%;
    max-width: 100%;
  }

  .card-header {
    background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%) !important;
    border-bottom: 1px solid rgba(0, 0, 0, .125);
    border-top: 3px solid #007bff;
    padding: .75rem 1.25rem;
    position: relative;
    border-top-left-radius: .25rem;
    border-top-right-radius: .25rem;
  }

  .card-title {
    float: left !important;
    float: left;
    font-size: 1.1rem;
    font-weight: 400;
    margin: 0;
    color: #ffff;
    font-weight: 500;
  }

  .light-blue{
    background-color: #3c8dbc !important;
  }

  .second-head{
    color: #fff !important;
    font-weight: bold;
    font-size: 16px;
  }

  @media (max-width: 339px) {
    .input-group{
      flex-direction: column !important;
    }

    .card-header{
      flex-direction: column !important;
      grid-template-columns: 12px;
    }
  }
  @media (max-width: 475px) {

    .card-header{
      flex-direction: column !important;
      grid-template-columns: 12px;
      
    }
}
</style>
{% endblock %}